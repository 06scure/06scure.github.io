---
title:  Claude Code 部署
date: {{ 20251015 }}
tags: 
  - VScode
  - 大模型
  - AI
categories:
  - 工具配置
---
## 一、安装

在VScode插件市场搜索Claude Code for VScode
![](https://qiniu.mingxuan.xin/picgo/202510140206102.png)
点击安装。在右上角有一个橙色图表即为安装成功。
![](https://qiniu.mingxuan.xin/picgo/202510140220057.png)
其次，在安装Claude Code本体。由于我之前装好了node.js，所以暂时不需要。打开命令行直接安装:
```bash
npm install -g @anthropic-ai/claude-code
```
安装好后可以使用命令验证:
```bash
claude --version
```
![](https://qiniu.mingxuan.xin/picgo/202510141612035.png)

## 二、获取国产大模型

Claude Code的原生模型有被封号的风险，且母公司对华不友好，因此使用国产模型进行替代。如KIMI，GLM，QWEN等。

 - GLM Coding [智谱AI开放平台](https://bigmodel.cn/claude-code?utm_source=bigModel&utm_medium=Special&utm_content=glm-code&utm_campaign=Platform_Ops&_channel_track_key=8BAeCdUS)
 - Qwen Coder [大模型服务平台百炼控制台](https://bailian.console.aliyun.com/?tab=model#/api-key)

GLM带MCP服务器的版本每个月要100RMB，感觉有点负担不起，还是白嫖一下阿里吧~新注册用户有90天100W token的试用额度，后续收费见[模型列表与价格_大模型服务平台百炼(Model Studio)-阿里云帮助中心](https://help.aliyun.com/zh/model-studio/models)

在[大模型服务平台百炼控制台](https://bailian.console.aliyun.com/?tab=model#/api-key)创建一个API Key 并保存。

## 三、部署

首先更改Claude Code的配置文件。Windows的配置文件地址为`C:\Users\93741\.claude`

新建一个文件`settings.json`，写入如下内容:
```json
{
  "env": {
    "ANTHROPIC_BASE_URL": "https://dashscope.aliyuncs.com/apps/anthropic",
    "ANTHROPIC_AUTH_TOKEN": "你的API KEY",
    "ANTHROPIC_MODEL": "qwen3-coder-plus",
    "ANTHROPIC_SMALL_FAST_MODEL": "qwen3-coder-plus"
  }
}
```

接下来测试是否正常运行，新建一个新的终端，运行`claude`
![](https://qiniu.mingxuan.xin/picgo/202510141727477.png)
接下来一路回车即可，最终顺利进入界面。最后让我们测试一下效果。
![](https://qiniu.mingxuan.xin/picgo/20251014181026519.png)
额？这是喂了什么？阿里云后台查看了确实是调用的qwen3-coder，输入的token高达23.7k，恐怖...
![](https://qiniu.mingxuan.xin/picgo/20251014212150636.png)
为了防止费用爆炸，还是多查询一下剩余额度吧[大模型服务平台百炼控制台](https://bailian.console.aliyun.com/?spm=a2c4g.11186623.0.0.f668657bBTui0p&tab=model#/model-market/detail/qwen3-coder-plus)。
目前还不清楚阿里的计费规则，高强度用了一个月还没扣过费...



## 四、配置MCP服务器

在正式写代码前，我们可以考虑添加MCP服务器以提高AI的代码水平。可以添加常用的MCP如context7。
context7的api需要在[Context7 - Up-to-date documentation for LLMs and AI code editors](https://context7.com/sign-in?redirect_url=https%3A%2F%2Fcontext7.com%2Fdashboard)注册获取，更重要的是他是免费的。
接下来复制API KEY到以下指令中，然后在终端运行。
全局项目可用
```bash
claude mcp add -s user --transport http context7 https://mcp.context7.com/mcp --header "CONTEXT7_API_KEY: your_api_key"
```

配置完成之后，在claude的终端查询是否安装成功。以下是在vscode终端中查询：
![](https://qiniu.mingxuan.xin/picgo/20251014214412099.png)
输入后提示，则成功添加MCP服务器:
![](https://qiniu.mingxuan.xin/picgo/20251014214537849.png)
为了防止token爆炸，还是要选择性使用MCP。
## 五、代码实战

常见的命令可以参考官方文档[快速开始 - Claude Docs](https://docs.claude.com/zh-CN/docs/claude-code/quickstart#%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4)，这里只以项目实战中常用的指令介绍。

VScode终端右下角的`“/”`已经集成绝大部分功能，比如查看模型，查看MCP服务器等，比之前GEMINI插件人性化很多，不过有时可能习惯性手打一些指令去操作。以下是几个我个人常用的指令：

##### /init
当处理一个全新的项目时，使用`/init`来让AI阅读整个项目的大纲文件，对其有个整体感知。
![](https://qiniu.mingxuan.xin/picgo/20251014222050465.png)
选择Yes即可。

##### /compact

适时的压缩上下文有利于节省我们的钱包，不过根据我在GEMINI的使用经验上来说，还是非常容易丢信息的。

##### /clear /memory /status

这几个放到一起说单独是因为插件功能太完善了，会自动保存，也能看到之前的对话，所以没用过，命令行用户可能考虑一下。

##### /cost
该指令用于统计会话使用token数量，节省使用。
![](https://qiniu.mingxuan.xin/picgo/20251014230540269.png)

##### @file
和gemini相同，喂文件直接用`@`的相对路径即可。

##### Mode
Claude Code支持几种模式，比如：
 - `plan mode on` 该模式用于计划整体方案，一般在项目规划时使用；
 - `Ask before edits` 最常用的模式，用于更改代码；
 - `Edit automatically` 自动编辑模式，感觉是炫技，写程序需要调试，应当一步步的来。

## 六、参考资料

 - [Claude Code - 接入 GLM 4.6 模型](https://www.yuque.com/xiaoyou-nwu1w/ooi105/ezbqz1el31ekgt3k)
 - [大模型服务平台百炼控制台](https://bailian.console.aliyun.com/?tab=doc#/doc/?type=model&url=2949529)
 - [context7/docs/README.zh-CN.md at master · upstash/context7](https://github.com/upstash/context7/blob/master/docs/README.zh-CN.md)
